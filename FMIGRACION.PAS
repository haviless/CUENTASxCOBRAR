unit FMigracion;

interface

uses
  Windows, Messages, SysUtils, Classes, Graphics, Controls, Forms, Dialogs,
  StdCtrls, ExtCtrls;

type
  TForm1 = class(TForm)
    Button1: TButton;
    Panel1: TPanel;
    Button2: TButton;
    Button3: TButton;
    Button4: TButton;
    Button5: TButton;
    Button6: TButton;
    Button7: TButton;
    Button8: TButton;
    Button9: TButton;
    Button10: TButton;
    Button11: TButton;
    Button12: TButton;
    Button13: TButton;
    Button14: TButton;
    Button15: TButton;
    Button16: TButton;
    procedure Button1Click(Sender: TObject);
    procedure Button2Click(Sender: TObject);
    procedure Button3Click(Sender: TObject);
    procedure Button4Click(Sender: TObject);
    procedure Button5Click(Sender: TObject);
    procedure Button6Click(Sender: TObject);
    procedure Button7Click(Sender: TObject);
    procedure Button8Click(Sender: TObject);
    procedure Button9Click(Sender: TObject);
    procedure Button10Click(Sender: TObject);
    procedure Button11Click(Sender: TObject);
    procedure Button12Click(Sender: TObject);
    procedure Button13Click(Sender: TObject);
    procedure Button14Click(Sender: TObject);
    procedure Button15Click(Sender: TObject);
    procedure Button16Click(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  Form1: TForm1;

implementation

uses CxCDM;

{$R *.DFM}

procedure TForm1.Button1Click(Sender: TObject);
var sSQL:string;
begin
  Screen.Cursor:=crHourGlass;
  Panel1.caption:=' GENERANDO LETRAS CANCELADAS ';
  panel1.visible:=True;
  Panel1.refresh;

  sSQL:=' INSERT INTO CXC301 '+
        ' (CIAID,CCANOMES,TDIARID,CCLOTE,CCNOREG,CCFCMPRB,CLAUXID,CLIEID,CLIEDES,CLIERUC,DOCID,CCSERIE,CCNODOC,CCFEMIS, '+
        ' CCFVCMTO,TMONID,CCTCAMPR,CCESTADO,CCOMERID,CCGRAVAD,CCIGV,CCMTOORI,CCMTOLOC,CCMTOEXT,CCPAGORI,CCPAGLOC, '+
        ' CCPAGEXT,CCSALORI,CCSALLOC,CCSALEXT,CCUSER,CCFREG,TVTAID,BANCOID,CCNLETBCO,SITID,UBIID,FLAGVAR,ZVTAID,CCPTOTOT,CTATOTAL,CCFLAGPROT) '+
        ' SELECT ''01'' CIAID,RTRIM(LTRIM(CHAR(YEAR(FECEMI))))||CASE WHEN MONTH(FECEMI)>9 THEN CHAR(MONTH(FECEMI)) ELSE         ''0''||CHAR(MONTH(FECEMI)) END CCANOMES, '+
        ' ''32'' TDIARID,''000'' CCLOTE,CCNOREG, FECEMI CCFCMPRB,''03'' CLAUXID,IFTLET01.CDCLIE CLIEID, '+
        ' '''' CLIEDES,'''' CLIERUC, '+
        ' ''05'' DOCID, '+
        ' ''000'' CCSERIE,CDLETRA CCNODOC,FECEMI CCFEMIS,FEVENC CCFVCMTO, '+
        ' TPMONE TMONID,TPCAMB CCTCAMPR,''C'' CCESTADO,CDCONDI CCOMERID, '+
        ' ROUND(COALESCE(IMLETRA,0)*0.82,2) CCGRAVAD, '+
        ' ROUND(COALESCE(IMLETRA,0)*0.18,2) CCIGV, '+
        ' COALESCE(IMLETRA,0)+COALESCE(IGV,0) CCMTOORI, '+
        ' ROUND((COALESCE(IMLETRA,0)+COALESCE(IGV,0))*COALESCE(TPCAMB,1),2) CCMTOLOC, '+
        ' COALESCE(IMLETRA,0)+COALESCE(IGV,0) CCMTOEXT, '+
        ' ROUND(COALESCE(IMLETRA,0)+COALESCE(IGV,0)-COALESCE(SALDO,0),2) CCPAGORI , '+
        ' ROUND((COALESCE(IMLETRA,0)+COALESCE(IGV,0)-COALESCE(SALDO,0))*COALESCE(TPCAMB,1),2) CCPAGLOC , '+
        ' ROUND(COALESCE(IMLETRA,0)+COALESCE(IGV,0)-COALESCE(SALDO,0),2) CCPAGEXT , '+
        ' COALESCE(SALDO,0) CCSALORI, '+
        ' ROUND(COALESCE(SALDO,0)*COALESCE(TPCAMB,1),2) CCSALLOC, '+
        ' COALESCE(SALDO,0) CCSALEXT, '+
        ' IFTLET01.CDUSER, '+
        ' CURRENT DATE CCFREG,SUBSTR(IFTLET01.CDZONA,1,2) TVTAID, '+
        ' CASE WHEN CDBANC=''03'' THEN ''02''ELSE CDBANC END BANCOID,NRUNICO CCNLETBCO, '+
        ' CASE WHEN STLETRA=''01'' AND CDMODO=''03'' AND CDBANC=''01'' THEN ''10'' ELSE '+
        ' CASE WHEN STLETRA=''01'' AND CDMODO IS NULL AND CDBANC IS NULL THEN ''01'' ELSE '+
        ' CASE WHEN STLETRA=''02'' AND CDMODO=''03'' AND CDBANC=''01'' THEN ''10'' ELSE '+
        ' CASE WHEN STLETRA=''02'' AND CDMODO=''03'' AND CDBANC=''03'' THEN ''10'' ELSE '+
        ' CASE WHEN STLETRA=''02'' AND CDMODO IS NULL AND CDBANC IS NULL THEN ''10'' ELSE '+
        ' CASE WHEN STLETRA=''03'' AND CDMODO=''01'' AND CDBANC=''01'' THEN ''20'' ELSE '+
        ' CASE WHEN STLETRA=''03'' AND CDMODO=''02'' AND CDBANC=''01'' THEN ''30'' ELSE '+
        ' CASE WHEN STLETRA=''03'' AND CDMODO=''02'' AND CDBANC=''03'' THEN ''30'' ELSE '+
        ' CASE WHEN STLETRA=''03'' AND CDMODO=''02'' AND CDBANC=''20'' THEN ''30'' ELSE '+
        ' CASE WHEN STLETRA=''03'' AND CDMODO=''03'' AND CDBANC=''01'' THEN ''20'' ELSE '+
        ' CASE WHEN STLETRA=''03'' AND CDMODO=''03'' AND CDBANC=''20'' THEN ''20'' ELSE '+
        ' CASE WHEN STLETRA=''03'' AND CDMODO=''03'' AND CDBANC=''03'' THEN ''20'' ELSE '+
        ' CASE WHEN STLETRA=''04'' AND CDMODO=''02'' AND CDBANC=''01'' THEN ''31'' ELSE '+
        ' CASE WHEN STLETRA=''04'' AND CDMODO=''02'' AND CDBANC=''03'' THEN ''31'' ELSE '+
        ' CASE WHEN STLETRA=''04'' AND CDMODO=''03'' AND CDBANC=''01'' THEN ''21'' ELSE '+
        ' CASE WHEN STLETRA=''04'' AND CDMODO=''03'' AND CDBANC=''03'' THEN ''21'' ELSE '+
        ' CASE WHEN STLETRA=''04'' AND CDMODO IS NULL AND CDBANC IS NULL THEN ''12'' ELSE '+
        ' CASE WHEN STLETRA=''05'' AND CDMODO=''01'' AND CDBANC=''01'' THEN ''24'' ELSE '+
        ' CASE WHEN STLETRA=''05'' AND CDMODO=''02'' AND CDBANC=''01'' THEN ''34'' ELSE '+
        ' CASE WHEN STLETRA=''05'' AND CDMODO=''02'' AND CDBANC=''02'' THEN ''34'' ELSE '+
        ' CASE WHEN STLETRA=''05'' AND CDMODO=''02'' AND CDBANC=''03'' THEN ''34'' ELSE '+
        ' CASE WHEN STLETRA=''05'' AND CDMODO=''03'' AND CDBANC IS NULL THEN ''34'' ELSE '+
        ' CASE WHEN STLETRA=''05'' AND CDMODO=''03'' AND CDBANC=''01'' THEN ''24'' ELSE '+
        ' CASE WHEN STLETRA=''05'' AND CDMODO=''03'' AND CDBANC=''03'' THEN ''24'' ELSE '+
        ' CASE WHEN STLETRA=''05'' AND CDMODO IS NULL AND CDBANC=''01'' THEN ''24'' ELSE '+
        ' CASE WHEN STLETRA=''05'' AND CDMODO IS NULL AND CDBANC=''03'' THEN ''24'' ELSE '+
        ' CASE WHEN STLETRA=''05'' AND CDMODO IS NULL AND CDBANC IS NULL THEN ''14'' ELSE '+
        ' CASE WHEN STLETRA=''06'' AND CDMODO=''02'' AND CDBANC=''01'' THEN ''13'' ELSE '+
        ' CASE WHEN STLETRA=''06'' AND CDMODO=''02'' AND CDBANC=''02'' THEN ''13'' ELSE '+
        ' CASE WHEN STLETRA=''06'' AND CDMODO=''03'' AND CDBANC=''01'' THEN ''13'' ELSE '+
        ' CASE WHEN STLETRA=''06'' AND CDMODO=''03'' AND CDBANC=''03'' THEN ''13'' ELSE '+
        ' CASE WHEN STLETRA=''06'' AND CDMODO IS NULL AND CDBANC IS NULL THEN ''13'' ELSE '+
        ' CASE WHEN STLETRA=''07'' AND CDMODO=''01'' AND CDBANC=''01'' THEN ''16'' ELSE '+
        ' CASE WHEN STLETRA=''07'' AND CDMODO=''02'' AND CDBANC=''01'' THEN ''16'' ELSE '+
        ' CASE WHEN STLETRA=''07'' AND CDMODO=''03'' AND CDBANC=''01'' THEN ''16'' ELSE '+
        ' CASE WHEN STLETRA=''07'' AND CDMODO=''03'' AND CDBANC=''03'' THEN ''16'' ELSE '+
        ' CASE WHEN STLETRA=''07'' AND CDMODO IS NULL AND CDBANC IS NULL THEN ''16'' ELSE '+
        ' CASE WHEN STLETRA=''08'' AND CDMODO=''01'' AND CDBANC=''01'' THEN ''17'' ELSE '+
        ' CASE WHEN STLETRA=''08'' AND CDMODO=''02'' AND CDBANC=''01'' THEN ''17'' ELSE '+
        ' CASE WHEN STLETRA=''08'' AND CDMODO=''03'' AND CDBANC=''01'' THEN ''17'' ELSE '+
        ' CASE WHEN STLETRA=''08'' AND CDMODO IS NULL AND CDBANC=''01'' THEN ''17'' ELSE '+
        ' CASE WHEN STLETRA=''08'' AND CDMODO IS NULL AND CDBANC IS NULL THEN ''17'' ELSE '+
        ' CASE WHEN STLETRA=''08'' AND CDMODO=''03'' AND CDBANC=''03'' THEN ''17'' ELSE '+
        ' '''' END END END END END END END END END END END END END END END END END END '+
        ' END END END END END END END END END END END END END END END END END END '+
        '   END END END END  END END END SITID, '+
        ' CASE WHEN STLETRA=''02'' THEN ''03'' ELSE '+
        ' CASE WHEN STLETRA=''03'' THEN CASE WHEN CDBANC=''03'' THEN ''02'' ELSE CDBANC END ELSE '+
        ' CASE WHEN STLETRA IN (''04'',''05'',''06'') AND CDMODO IS NOT NULL THEN CASE WHEN CDBANC=''03'' THEN ''02'' ELSE CDBANC END ELSE '+
        ' '''' END END END UBIID,''.'' FLAGVAR,CDZONA  ZVTAID, '+
        ' CASE WHEN SUBSTR(IFTLET01.CDZONA,1,2)=''01'' THEN ''05013'' ELSE ''05014'' END CCPTOTOT, '+
        ' CASE WHEN SUBSTR(IFTLET01.CDZONA,1,2)=''01'' THEN ''123010201'' ELSE ''123010250'' END CTATOTAL, '+
        ' CASE WHEN FEPROTES IS NOT NULL THEN ''S'' ELSE NULL END CCFLAGPROT '+
        ' FROM CIFTLET1 IFTLET01 ';
     try
       DM1.DCOM1.AppServer.EjecutaSQL(sSQL);
     except
       Raise Exception.Create('Se ha producido un Error al Migrar las Letras Canceladas');
     end;
  panel1.visible:=False;
  Screen.Cursor:=crDefault;
  ShowMessage('Se Migraron Correctamente las Letras Canceladas');

end;

procedure TForm1.Button2Click(Sender: TObject);
var sSQL:string;
begin
  Screen.Cursor:=crHourGlass;
  Panel1.caption:=' GENERANDO LETRAS CON SALDO ';
  panel1.visible:=True;
  Panel1.refresh;

  sSQL:=' INSERT INTO CXC301 '+
        ' (CIAID,CCANOMES,TDIARID,CCLOTE,CCNOREG,CCFCMPRB,CLAUXID,CLIEID,CLIEDES,CLIERUC,DOCID,CCSERIE,CCNODOC,CCFEMIS, '+
        ' CCFVCMTO,TMONID,CCTCAMPR,CCESTADO,CCOMERID,CCGRAVAD,CCIGV,CCMTOORI,CCMTOLOC,CCMTOEXT,CCPAGORI,CCPAGLOC, '+
        ' CCPAGEXT,CCSALORI,CCSALLOC,CCSALEXT,CCUSER,CCFREG,TVTAID,BANCOID,CCNLETBCO,SITID,UBIID,FLAGVAR,ZVTAID,CCPTOTOT,CTATOTAL,CCFLAGPROT) '+
        ' SELECT ''01'' CIAID,RTRIM(LTRIM(CHAR(YEAR(FECEMI))))||CASE WHEN MONTH(FECEMI)>9 THEN CHAR(MONTH(FECEMI)) ELSE         ''0''||CHAR(MONTH(FECEMI)) END CCANOMES, '+
        ' ''32'' TDIARID,''000'' CCLOTE,CCNOREG, FECEMI CCFCMPRB,''03'' CLAUXID,IFTLET01.CDCLIE CLIEID, '+
        ' '''' CLIEDES,'''' CLIERUC, '+
        ' ''05'' DOCID, '+
        ' ''000'' CCSERIE,CDLETRA CCNODOC,FECEMI CCFEMIS,FEVENC CCFVCMTO, '+
        ' TPMONE TMONID,TPCAMB CCTCAMPR,''P'' CCESTADO,CDCONDI CCOMERID, '+
        ' ROUND(COALESCE(IMLETRA,0)*0.82,2) CCGRAVAD, '+
        ' ROUND(COALESCE(IMLETRA,0)*0.18,2) CCIGV, '+
        ' COALESCE(IMLETRA,0)+COALESCE(IGV,0) CCMTOORI, '+
        ' ROUND((COALESCE(IMLETRA,0)+COALESCE(IGV,0))*COALESCE(TPCAMB,1),2) CCMTOLOC, '+
        ' COALESCE(IMLETRA,0)+COALESCE(IGV,0) CCMTOEXT, '+
        ' ROUND(COALESCE(IMLETRA,0)+COALESCE(IGV,0)-COALESCE(SALDO,0),2) CCPAGORI , '+
        ' ROUND((COALESCE(IMLETRA,0)+COALESCE(IGV,0)-COALESCE(SALDO,0))*COALESCE(TPCAMB,1),2) CCPAGLOC , '+
        ' ROUND(COALESCE(IMLETRA,0)+COALESCE(IGV,0)-COALESCE(SALDO,0),2) CCPAGEXT , '+
        ' COALESCE(SALDO,0) CCSALORI, '+
        ' ROUND(COALESCE(SALDO,0)*COALESCE(TPCAMB,1),2) CCSALLOC, '+
        ' COALESCE(SALDO,0) CCSALEXT, '+
        ' IFTLET01.CDUSER, '+
        ' CURRENT DATE CCFREG,SUBSTR(IFTLET01.CDZONA,1,2) TVTAID, '+
        ' CASE WHEN CDBANC=''03'' THEN ''02''ELSE CDBANC END BANCOID,NRUNICO CCNLETBCO, '+
        ' CASE WHEN STLETRA=''01'' AND CDMODO=''03'' AND CDBANC=''01'' THEN ''10'' ELSE '+
        ' CASE WHEN STLETRA=''01'' AND CDMODO IS NULL AND CDBANC IS NULL THEN ''01'' ELSE '+
        ' CASE WHEN STLETRA=''02'' AND CDMODO=''03'' AND CDBANC=''01'' THEN ''10'' ELSE '+
        ' CASE WHEN STLETRA=''02'' AND CDMODO=''03'' AND CDBANC=''03'' THEN ''10'' ELSE '+
        ' CASE WHEN STLETRA=''02'' AND CDMODO IS NULL AND CDBANC IS NULL THEN ''10'' ELSE '+
        ' CASE WHEN STLETRA=''03'' AND CDMODO=''01'' AND CDBANC=''01'' THEN ''20'' ELSE '+
        ' CASE WHEN STLETRA=''03'' AND CDMODO=''02'' AND CDBANC=''01'' THEN ''30'' ELSE '+
        ' CASE WHEN STLETRA=''03'' AND CDMODO=''02'' AND CDBANC=''03'' THEN ''30'' ELSE '+
        ' CASE WHEN STLETRA=''03'' AND CDMODO=''02'' AND CDBANC=''20'' THEN ''30'' ELSE '+
        ' CASE WHEN STLETRA=''03'' AND CDMODO=''03'' AND CDBANC=''01'' THEN ''20'' ELSE '+
        ' CASE WHEN STLETRA=''03'' AND CDMODO=''03'' AND CDBANC=''20'' THEN ''20'' ELSE '+
        ' CASE WHEN STLETRA=''03'' AND CDMODO=''03'' AND CDBANC=''03'' THEN ''20'' ELSE '+
        ' CASE WHEN STLETRA=''04'' AND CDMODO=''02'' AND CDBANC=''01'' THEN ''62'' ELSE '+
        ' CASE WHEN STLETRA=''04'' AND CDMODO=''02'' AND CDBANC=''03'' THEN ''63'' ELSE '+
        ' CASE WHEN STLETRA=''04'' AND CDMODO=''03'' AND CDBANC=''01'' THEN ''64'' ELSE '+
        ' CASE WHEN STLETRA=''04'' AND CDMODO=''03'' AND CDBANC=''03'' THEN ''65'' ELSE '+
        ' CASE WHEN STLETRA=''04'' AND CDMODO IS NULL AND CDBANC IS NULL THEN ''12'' ELSE '+
        ' CASE WHEN STLETRA=''05'' AND CDMODO=''01'' AND CDBANC=''01'' THEN ''24'' ELSE '+
        ' CASE WHEN STLETRA=''05'' AND CDMODO=''02'' AND CDBANC=''01'' THEN ''34'' ELSE '+
        ' CASE WHEN STLETRA=''05'' AND CDMODO=''02'' AND CDBANC=''02'' THEN ''34'' ELSE '+
        ' CASE WHEN STLETRA=''05'' AND CDMODO=''02'' AND CDBANC=''03'' THEN ''34'' ELSE '+
        ' CASE WHEN STLETRA=''05'' AND CDMODO=''03'' AND CDBANC IS NULL THEN ''34'' ELSE '+
        ' CASE WHEN STLETRA=''05'' AND CDMODO=''03'' AND CDBANC=''01'' THEN ''24'' ELSE '+
        ' CASE WHEN STLETRA=''05'' AND CDMODO=''03'' AND CDBANC=''03'' THEN ''24'' ELSE '+
        ' CASE WHEN STLETRA=''05'' AND CDMODO IS NULL AND CDBANC=''01'' THEN ''24'' ELSE '+
        ' CASE WHEN STLETRA=''05'' AND CDMODO IS NULL AND CDBANC=''03'' THEN ''24'' ELSE '+
        ' CASE WHEN STLETRA=''05'' AND CDMODO IS NULL AND CDBANC IS NULL THEN ''14'' ELSE '+
        ' CASE WHEN STLETRA=''06'' AND CDMODO=''02'' AND CDBANC=''01'' THEN ''13'' ELSE '+
        ' CASE WHEN STLETRA=''06'' AND CDMODO=''02'' AND CDBANC=''02'' THEN ''13'' ELSE '+
        ' CASE WHEN STLETRA=''06'' AND CDMODO=''03'' AND CDBANC=''01'' THEN ''13'' ELSE '+
        ' CASE WHEN STLETRA=''06'' AND CDMODO=''03'' AND CDBANC=''03'' THEN ''13'' ELSE '+
        ' CASE WHEN STLETRA=''06'' AND CDMODO IS NULL AND CDBANC IS NULL THEN ''13'' ELSE '+
        ' CASE WHEN STLETRA=''07'' AND CDMODO=''01'' AND CDBANC=''01'' THEN ''16'' ELSE '+
        ' CASE WHEN STLETRA=''07'' AND CDMODO=''02'' AND CDBANC=''01'' THEN ''16'' ELSE '+
        ' CASE WHEN STLETRA=''07'' AND CDMODO=''03'' AND CDBANC=''01'' THEN ''16'' ELSE '+
        ' CASE WHEN STLETRA=''07'' AND CDMODO=''03'' AND CDBANC=''03'' THEN ''16'' ELSE '+
        ' CASE WHEN STLETRA=''07'' AND CDMODO IS NULL AND CDBANC IS NULL THEN ''16'' ELSE '+
        ' CASE WHEN STLETRA=''08'' AND CDMODO=''01'' AND CDBANC=''01'' THEN ''17'' ELSE '+
        ' CASE WHEN STLETRA=''08'' AND CDMODO=''02'' AND CDBANC=''01'' THEN ''17'' ELSE '+
        ' CASE WHEN STLETRA=''08'' AND CDMODO=''03'' AND CDBANC=''01'' THEN ''17'' ELSE '+
        ' CASE WHEN STLETRA=''08'' AND CDMODO IS NULL AND CDBANC=''01'' THEN ''17'' ELSE '+
        ' CASE WHEN STLETRA=''08'' AND CDMODO IS NULL AND CDBANC IS NULL THEN ''17'' ELSE '+
        ' CASE WHEN STLETRA=''08'' AND CDMODO=''03'' AND CDBANC=''03'' THEN ''17'' ELSE '+
        ' '''' END END END END END END END END END END END END END END END END END END '+
        ' END END END END END END END END END END END END END END END END END END '+
        '   END END END END  END END END SITID, '+
        ' CASE WHEN STLETRA=''02'' THEN ''03'' ELSE '+
        ' CASE WHEN STLETRA=''03'' THEN CASE WHEN CDBANC=''03'' THEN ''02'' ELSE CDBANC END ELSE '+
        ' CASE WHEN STLETRA IN (''04'',''05'',''06'') AND CDMODO IS NOT NULL THEN CASE WHEN CDBANC=''03'' THEN ''02'' ELSE CDBANC END ELSE '+
        ' '''' END END END UBIID,''.'' FLAGVAR,CDZONA  ZVTAID, '+
        ' CASE WHEN SUBSTR(IFTLET01.CDZONA,1,2)=''01'' THEN ''05013'' ELSE ''05014'' END CCPTOTOT, '+
        ' CASE WHEN SUBSTR(IFTLET01.CDZONA,1,2)=''01'' THEN ''123010201'' ELSE ''123010250'' END CTATOTAL, '+
        ' CASE WHEN FEPROTES IS NOT NULL THEN ''S'' ELSE NULL END CCFLAGPROT '+
        ' FROM SIFTLET1 IFTLET01 ';
     try
       DM1.DCOM1.AppServer.EjecutaSQL(sSQL);
     except
       Raise Exception.Create('Se ha producido un Error al Migrar las Letras con Saldo');
     end;
  panel1.visible:=False;
  Screen.Cursor:=crDefault;
  ShowMessage('Se Migraron Correctamente las Letras con Saldo');
end;

procedure TForm1.Button3Click(Sender: TObject);
var sSQL:string;
begin
  Screen.Cursor:=crHourGlass;
  Panel1.caption:=' GENERANDO FACTURAS CANCELADAS ';
  panel1.visible:=True;
  Panel1.refresh;

  sSQL:=' INSERT INTO CXC301( CIAID,CCNOREG,CCANOMES,TDIARID,CCFCMPRB,CLAUXID,CLIEID,CLIEDES,DOCID, '+
        ' CCSERIE,CCNODOC,CCFEMIS,CCFVCMTO,TMONID,CCTCAMPR,CCESTADO, '+
        ' CCOMERID,CCGRAVAD,CCIGV,CCMTOORI,CCMTOLOC,CCMTOEXT,CCPAGORI,CCPAGLOC,CCPAGEXT, '+
        ' CCSALORI,CCSALLOC,CCSALEXT, '+
        ' CCFLETE,CCUSER,CCFREG,TVTAID,FLAGVAR,ZVTAID,CCPTOTOT,CTATOTAL,UBIID  ) '+
        ' SELECT ''01'' CIAID,CCNOREG, '+
        ' RTRIM(LTRIM(CHAR(YEAR(FECEMI))))||CASE WHEN MONTH(FECEMI)>9 THEN CHAR(MONTH(FECEMI)) ELSE         ''0''||CHAR(MONTH(FECEMI)) END CCANOMES, '+
        ' ''49'' TDIARID,FECEMI CCFCMPRB,''03'' CLAUXID,CDCLIE CLIEID,'''' CLIEDES,''13'' DOCID, '+
        ' SUBSTR(NRDOCU,1,3) CCSERIE,SUBSTR(NRDOCU,4,7) CCNODOC,FECEMI CCFEMIS,FEVENC CCFVCMTO, '+
        ' TPMONE TMONID,TPCAMB CCTCAMPR,''C'' CCESTADO, CDCONDI CCOMERID, '+
        ' NETO_S_IGV CCGRAVAD,IGV , '+
        ' COALESCE(IGV,0)+COALESCE(EMBALAJE,0)+COALESCE(NETO_S_IGV,0) CCMTOORI, '+
        ' ROUND( (COALESCE(IGV,0)+COALESCE(EMBALAJE,0)+COALESCE(NETO_S_IGV,0))*COALESCE(TPCAMB,1),2) CCMTOLOC, '+
        ' COALESCE(IGV,0)+COALESCE(EMBALAJE,0)+COALESCE(NETO_S_IGV,0) CCMTOEXT, '+
        ' ROUND(COALESCE(IGV,0)+COALESCE(EMBALAJE,0)+COALESCE(NETO_S_IGV,0)-COALESCE(SALDO,0),2) CCPAGORI, '+
        ' ROUND((COALESCE(IGV,0)+COALESCE(EMBALAJE,0)+COALESCE(NETO_S_IGV,0)-COALESCE(SALDO,0))*COALESCE(TPCAMB,1),2) CCPAGLOC, '+
        ' ROUND(COALESCE(IGV,0)+COALESCE(EMBALAJE,0)+COALESCE(NETO_S_IGV,0)-COALESCE(SALDO,0),2) CCPAGEXT, '+
        ' COALESCE(SALDO,0) CCSALORI, '+
        ' ROUND(COALESCE(SALDO,0)*COALESCE(TPCAMB,1),2) CCSALLOC, '+
        ' COALESCE(SALDO,0) CCSALEXT, EMBALAJE, '+
        ' CDUSER CCUSER,CURRENT DATE CCFREG,SUBSTR(CDZONA,1,2) TVTAID,''.'' FLAGVAR, CDZONA ZVTAID, '+
        ' CASE WHEN SUBSTR(CDZONA,1,2)=''01'' THEN ''13013'' ELSE ''13014'' END CCPTOTOT, '+
        ' CASE WHEN SUBSTR(CDZONA,1,2)=''01'' THEN ''121010201'' ELSE ''121010250'' END CTATOTAL,''03'' UBIID '+
        ' FROM CICTMOV1 ICTMOV01 '+
        ' WHERE TPDOCU=''03''';

     try
       DM1.DCOM1.AppServer.EjecutaSQL(sSQL);
     except
       Raise Exception.Create('Se ha producido un Error al Migrar las Facturas Canceladas');
     end;
  panel1.visible:=False;
  Screen.Cursor:=crDefault;
  ShowMessage('Se Migraron Correctamente las Facturas Canceladas');


end;

procedure TForm1.Button4Click(Sender: TObject);
var sSQL:string;
begin
  Screen.Cursor:=crHourGlass;
  Panel1.caption:=' GENERANDO FACTURAS CON SALDO ';
  panel1.visible:=True;
  Panel1.refresh;

  sSQL:=' INSERT INTO CXC301( CIAID,CCNOREG,CCANOMES,TDIARID,CCFCMPRB,CLAUXID,CLIEID,CLIEDES,DOCID, '+
        ' CCSERIE,CCNODOC,CCFEMIS,CCFVCMTO,TMONID,CCTCAMPR,CCESTADO, '+
        ' CCOMERID,CCGRAVAD,CCIGV,CCMTOORI,CCMTOLOC,CCMTOEXT,CCPAGORI,CCPAGLOC,CCPAGEXT, '+
        ' CCSALORI,CCSALLOC,CCSALEXT, '+
        ' CCFLETE,CCUSER,CCFREG,TVTAID,FLAGVAR,ZVTAID,CCPTOTOT,CTATOTAL,UBIID  ) '+
        ' SELECT ''01'' CIAID,CCNOREG, '+
        ' RTRIM(LTRIM(CHAR(YEAR(FECEMI))))||CASE WHEN MONTH(FECEMI)>9 THEN CHAR(MONTH(FECEMI)) ELSE         ''0''||CHAR(MONTH(FECEMI)) END CCANOMES, '+
        ' ''49'' TDIARID,FECEMI CCFCMPRB,''03'' CLAUXID,CDCLIE CLIEID,'''' CLIEDES,''13'' DOCID, '+
        ' SUBSTR(NRDOCU,1,3) CCSERIE,SUBSTR(NRDOCU,4,7) CCNODOC,FECEMI CCFEMIS,FEVENC CCFVCMTO, '+
        ' TPMONE TMONID,TPCAMB CCTCAMPR,''P'' CCESTADO, CDCONDI CCOMERID, '+
        ' NETO_S_IGV CCGRAVAD,IGV , '+
        ' COALESCE(IGV,0)+COALESCE(EMBALAJE,0)+COALESCE(NETO_S_IGV,0) CCMTOORI, '+
        ' ROUND( (COALESCE(IGV,0)+COALESCE(EMBALAJE,0)+COALESCE(NETO_S_IGV,0))*COALESCE(TPCAMB,1),2) CCMTOLOC, '+
        ' COALESCE(IGV,0)+COALESCE(EMBALAJE,0)+COALESCE(NETO_S_IGV,0) CCMTOEXT, '+
        ' ROUND(COALESCE(IGV,0)+COALESCE(EMBALAJE,0)+COALESCE(NETO_S_IGV,0)-COALESCE(SALDO,0),2) CCPAGORI, '+
        ' ROUND((COALESCE(IGV,0)+COALESCE(EMBALAJE,0)+COALESCE(NETO_S_IGV,0)-COALESCE(SALDO,0))*COALESCE(TPCAMB,1),2) CCPAGLOC, '+
        ' ROUND(COALESCE(IGV,0)+COALESCE(EMBALAJE,0)+COALESCE(NETO_S_IGV,0)-COALESCE(SALDO,0),2) CCPAGEXT, '+
        ' COALESCE(SALDO,0) CCSALORI, '+
        ' ROUND(COALESCE(SALDO,0)*COALESCE(TPCAMB,1),2) CCSALLOC, '+
        ' COALESCE(SALDO,0) CCSALEXT, EMBALAJE, '+
        ' CDUSER CCUSER,CURRENT DATE CCFREG,SUBSTR(CDZONA,1,2) TVTAID,''.'' FLAGVAR, CDZONA ZVTAID, '+
        ' CASE WHEN SUBSTR(CDZONA,1,2)=''01'' THEN ''13013'' ELSE ''13014'' END CCPTOTOT, '+
        ' CASE WHEN SUBSTR(CDZONA,1,2)=''01'' THEN ''121010201'' ELSE ''121010250'' END CTATOTAL,''03'' UBIID '+
        ' FROM SICTMOV1 ICTMOV01 '+
        ' WHERE TPDOCU=''03''';
     try
       DM1.DCOM1.AppServer.EjecutaSQL(sSQL);
     except
       Raise Exception.Create('Se ha producido un Error al Migrar las Facturas con Saldo');
     end;
  panel1.visible:=False;
  Screen.Cursor:=crDefault;
  ShowMessage('Se Migraron Correctamente las Facturas con Saldo');
end;

procedure TForm1.Button5Click(Sender: TObject);
var sSQL:string;
begin
  Screen.Cursor:=crHourGlass;
  Panel1.caption:=' GENERANDO BOLETAS CANCELADAS ';
  panel1.visible:=True;
  Panel1.refresh;

  sSQL:=' INSERT INTO CXC301( CIAID,CCNOREG,CCANOMES,TDIARID,CCFCMPRB,CLAUXID,CLIEID,CLIEDES,DOCID, '+
        ' CCSERIE,CCNODOC,CCFEMIS,CCFVCMTO,TMONID,CCTCAMPR,CCESTADO, '+
        ' CCOMERID,CCGRAVAD,CCIGV,CCMTOORI,CCMTOLOC,CCMTOEXT,CCPAGORI,CCPAGLOC,CCPAGEXT, '+
        ' CCSALORI,CCSALLOC,CCSALEXT, '+
        ' CCFLETE,CCUSER,CCFREG,TVTAID,FLAGVAR,ZVTAID,CCPTOTOT,CTATOTAL,UBIID  ) '+
        ' SELECT ''01'' CIAID,CCNOREG, '+
        ' RTRIM(LTRIM(CHAR(YEAR(FECEMI))))||CASE WHEN MONTH(FECEMI)>9 THEN CHAR(MONTH(FECEMI)) ELSE         ''0''||CHAR(MONTH(FECEMI)) END CCANOMES, '+
        ' ''49'' TDIARID,FECEMI CCFCMPRB,''03'' CLAUXID,CDCLIE CLIEID,'''' CLIEDES,''21'' DOCID, '+
        ' SUBSTR(NRDOCU,1,3) CCSERIE,SUBSTR(NRDOCU,4,7) CCNODOC,FECEMI CCFEMIS,FEVENC CCFVCMTO, '+
        ' TPMONE TMONID,TPCAMB CCTCAMPR,''C'' CCESTADO, CDCONDI CCOMERID, '+
        ' NETO_S_IGV CCGRAVAD,IGV , '+
        ' COALESCE(IGV,0)+COALESCE(EMBALAJE,0)+COALESCE(NETO_S_IGV,0) CCMTOORI, '+
        ' ROUND( (COALESCE(IGV,0)+COALESCE(EMBALAJE,0)+COALESCE(NETO_S_IGV,0))*COALESCE(TPCAMB,1),2) CCMTOLOC, '+
        ' COALESCE(IGV,0)+COALESCE(EMBALAJE,0)+COALESCE(NETO_S_IGV,0) CCMTOEXT, '+
        ' ROUND(COALESCE(IGV,0)+COALESCE(EMBALAJE,0)+COALESCE(NETO_S_IGV,0)-COALESCE(SALDO,0),2) CCPAGORI, '+
        ' ROUND((COALESCE(IGV,0)+COALESCE(EMBALAJE,0)+COALESCE(NETO_S_IGV,0)-COALESCE(SALDO,0))*COALESCE(TPCAMB,1),2) CCPAGLOC, '+
        ' ROUND(COALESCE(IGV,0)+COALESCE(EMBALAJE,0)+COALESCE(NETO_S_IGV,0)-COALESCE(SALDO,0),2) CCPAGEXT, '+
        ' COALESCE(SALDO,0) CCSALORI, '+
        ' ROUND(COALESCE(SALDO,0)*COALESCE(TPCAMB,1),2) CCSALLOC, '+
        ' COALESCE(SALDO,0) CCSALEXT, EMBALAJE, '+
        ' CDUSER CCUSER,CURRENT DATE CCFREG,SUBSTR(CDZONA,1,2) TVTAID,''.'' FLAGVAR, CDZONA ZVTAID, '+
        ' CASE WHEN SUBSTR(CDZONA,1,2)=''01'' THEN ''21013'' ELSE ''21014'' END CCPTOTOT, '+
        ' CASE WHEN SUBSTR(CDZONA,1,2)=''01'' THEN ''121020201'' ELSE ''121020250'' END CTATOTAL,''03'' UBIID '+
        ' FROM CICTMOV1 ICTMOV01 '+
        ' WHERE TPDOCU=''04''';
     try
       DM1.DCOM1.AppServer.EjecutaSQL(sSQL);
     except
       Raise Exception.Create('Se ha producido un Error al Migrar las Boletas Canceladas');
     end;
  panel1.visible:=False;
  Screen.Cursor:=crDefault;
  ShowMessage('Se Migraron Correctamente las Boletas Canceladas');
end;

procedure TForm1.Button6Click(Sender: TObject);
var sSQL:string;
begin
  Screen.Cursor:=crHourGlass;
  Panel1.caption:=' GENERANDO BOLETAS CON SALDO ';
  panel1.visible:=True;
  Panel1.refresh;

  sSQL:=' INSERT INTO CXC301( CIAID,CCNOREG,CCANOMES,TDIARID,CCFCMPRB,CLAUXID,CLIEID,CLIEDES,DOCID, '+
        ' CCSERIE,CCNODOC,CCFEMIS,CCFVCMTO,TMONID,CCTCAMPR,CCESTADO, '+
        ' CCOMERID,CCGRAVAD,CCIGV,CCMTOORI,CCMTOLOC,CCMTOEXT,CCPAGORI,CCPAGLOC,CCPAGEXT, '+
        ' CCSALORI,CCSALLOC,CCSALEXT, '+
        ' CCFLETE,CCUSER,CCFREG,TVTAID,FLAGVAR,ZVTAID,CCPTOTOT,CTATOTAL,UBIID  ) '+
        ' SELECT ''01'' CIAID,CCNOREG, '+
        ' RTRIM(LTRIM(CHAR(YEAR(FECEMI))))||CASE WHEN MONTH(FECEMI)>9 THEN CHAR(MONTH(FECEMI)) ELSE         ''0''||CHAR(MONTH(FECEMI)) END CCANOMES, '+
        ' ''49'' TDIARID,FECEMI CCFCMPRB,''03'' CLAUXID,CDCLIE CLIEID,'''' CLIEDES,''21'' DOCID, '+
        ' SUBSTR(NRDOCU,1,3) CCSERIE,SUBSTR(NRDOCU,4,7) CCNODOC,FECEMI CCFEMIS,FEVENC CCFVCMTO, '+
        ' TPMONE TMONID,TPCAMB CCTCAMPR,''P'' CCESTADO, CDCONDI CCOMERID, '+
        ' NETO_S_IGV CCGRAVAD,IGV , '+
        ' COALESCE(IGV,0)+COALESCE(EMBALAJE,0)+COALESCE(NETO_S_IGV,0) CCMTOORI, '+
        ' ROUND( (COALESCE(IGV,0)+COALESCE(EMBALAJE,0)+COALESCE(NETO_S_IGV,0))*COALESCE(TPCAMB,1),2) CCMTOLOC, '+
        ' COALESCE(IGV,0)+COALESCE(EMBALAJE,0)+COALESCE(NETO_S_IGV,0) CCMTOEXT, '+
        ' ROUND(COALESCE(IGV,0)+COALESCE(EMBALAJE,0)+COALESCE(NETO_S_IGV,0)-COALESCE(SALDO,0),2) CCPAGORI, '+
        ' ROUND((COALESCE(IGV,0)+COALESCE(EMBALAJE,0)+COALESCE(NETO_S_IGV,0)-COALESCE(SALDO,0))*COALESCE(TPCAMB,1),2) CCPAGLOC, '+
        ' ROUND(COALESCE(IGV,0)+COALESCE(EMBALAJE,0)+COALESCE(NETO_S_IGV,0)-COALESCE(SALDO,0),2) CCPAGEXT, '+
        ' COALESCE(SALDO,0) CCSALORI, '+
        ' ROUND(COALESCE(SALDO,0)*COALESCE(TPCAMB,1),2) CCSALLOC, '+
        ' COALESCE(SALDO,0) CCSALEXT, EMBALAJE, '+
        ' CDUSER CCUSER,CURRENT DATE CCFREG,SUBSTR(CDZONA,1,2) TVTAID,''.'' FLAGVAR, CDZONA ZVTAID, '+
        ' CASE WHEN SUBSTR(CDZONA,1,2)=''01'' THEN ''21013'' ELSE ''21014'' END CCPTOTOT, '+
        ' CASE WHEN SUBSTR(CDZONA,1,2)=''01'' THEN ''121020201'' ELSE ''121020250'' END CTATOTAL,''03'' UBIID '+
        ' FROM SICTMOV1 ICTMOV01 '+
        ' WHERE TPDOCU=''04''';
     try
       DM1.DCOM1.AppServer.EjecutaSQL(sSQL);
     except
       Raise Exception.Create('Se ha producido un Error al Migrar las Boletas con Saldo');
     end;
  panel1.visible:=False;
  Screen.Cursor:=crDefault;
  ShowMessage('Se Migraron Correctamente las Boletas con Saldo');
end;

procedure TForm1.Button7Click(Sender: TObject);
var sSQL:string;
begin
  Screen.Cursor:=crHourGlass;
  Panel1.caption:=' GENERANDO N. DEBITO CANCELADAS ';
  panel1.visible:=True;
  Panel1.refresh;

  sSQL:='INSERT INTO CXC301 '+
        ' (CIAID,CCANOMES,TDIARID,CCNOREG,CCFCMPRB,CLAUXID,CLIEID,CLIEDES,CLIERUC,DOCID,CCSERIE,CCNODOC,CCFEMIS, '+
        ' TMONID,CCTCAMPR,CCESTADO,CCGRAVAD,CCIGV,CCMTOORI,CCMTOLOC,CCMTOEXT,CCPAGORI,CCPAGLOC,CCPAGEXT, '+
        ' CCSALORI,CCSALLOC,CCSALEXT,CCUSER,CCFREG,CCHREG,FGEN_DOC,TVTAID,CCFLAGVTA,FLAGVAR,ZVTAID,CCPTOTOT,CTATOTAL,UBIID) '+
        ' SELECT ''01'' CIAID,RTRIM(LTRIM(CHAR(YEAR(FECEMI))))||CASE WHEN MONTH(FECEMI)>9 THEN CHAR(MONTH(FECEMI)) ELSE         ''0''||CHAR(MONTH(FECEMI)) END CCANOMES, '+
        ' ''49'' TDIARID,CCNOREG,FECEMI CCFCMPRB, ''03'' AUXID,N.CDCLIE CLIEID,'''' CLIEDES, '+
        ' '''' CLIERUC,''12'' DOCID,SUBSTR(CDNCARG,1,3) CCSERIE, '+
        ' SUBSTR(CDNCARG,4,7) CCNODOC,FECEMI CCFEMIS, TPMONE TMONID, TPCAMB CCTCAMPR, ''C'' CCESTADO, '+
        ' COALESCE(TOAFECT,0) CCGRAVAD,COALESCE(TOIGV,0) CCIGV,COALESCE(TOAFECT,0)+COALESCE(TOIGV,0) CCMTOORI, '+
        ' ROUND((COALESCE(TOAFECT,0)+COALESCE(TOIGV,0))*COALESCE(TPCAMB,1),2) CCMTOLOC, '+
        ' COALESCE(TOAFECT,0)+COALESCE(TOIGV,0) CCMTOEXT, '+
        ' ROUND(COALESCE(TOAFECT,0)+COALESCE(TOIGV,0)-SALDO,2) CCPAGORI, '+
        ' ROUND((COALESCE(TOAFECT,0)+COALESCE(TOIGV,0)-SALDO)*COALESCE(TPCAMB,1),2) CCPAGLOC, '+
        ' ROUND(COALESCE(TOAFECT,0)+COALESCE(TOIGV,0)-SALDO,2) CCPAGEXT, '+
        ' SALDO CCSALORI, ROUND(SALDO*COALESCE(TPCAMB,1),2) CCSALLOC, '+
        ' SALDO CCSALEXT,N.CDUSER CCUSER, CURRENT DATE CCFREG, CURRENT TIME CCHREG,''N'' FGEN_DOC, '+
        ' SUBSTR(N.CDZONA,1,2) TVTAID, ''.'' CCFLAGVTA,''.'' FLAGVAR, CDZONA ZVTAID, '+
        ' CASE WHEN SUBSTR(CDZONA,1,2)=''01'' THEN ''12074'' ELSE ''12073'' END CCPTOTOT, '+
        ' CASE WHEN SUBSTR(CDZONA,1,2)=''01'' THEN ''121030201'' ELSE ''121030250'' END CTATOTAL,''03'' UBIID '+
        ' FROM CICTNCG1 N ';
     try
       DM1.DCOM1.AppServer.EjecutaSQL(sSQL);
     except
       Raise Exception.Create('Se ha producido un Error al Migrar las N. Débito Canceladas');
     end;
  panel1.visible:=False;
  Screen.Cursor:=crDefault;
  ShowMessage('Se Migraron Correctamente las N. Débito Canceladas');
end;

procedure TForm1.Button8Click(Sender: TObject);
var sSQL:string;
begin
  Screen.Cursor:=crHourGlass;
  Panel1.caption:=' GENERANDO N. DEBITO CON SALDO ';
  panel1.visible:=True;
  Panel1.refresh;

  sSQL:='INSERT INTO CXC301 '+
        ' (CIAID,CCANOMES,TDIARID,CCNOREG,CCFCMPRB,CLAUXID,CLIEID,CLIEDES,CLIERUC,DOCID,CCSERIE,CCNODOC,CCFEMIS, '+
        ' TMONID,CCTCAMPR,CCESTADO,CCGRAVAD,CCIGV,CCMTOORI,CCMTOLOC,CCMTOEXT,CCPAGORI,CCPAGLOC,CCPAGEXT, '+
        ' CCSALORI,CCSALLOC,CCSALEXT,CCUSER,CCFREG,CCHREG,FGEN_DOC,TVTAID,CCFLAGVTA,FLAGVAR,ZVTAID,CCPTOTOT,CTATOTAL,UBIID) '+
        ' SELECT ''01'' CIAID,RTRIM(LTRIM(CHAR(YEAR(FECEMI))))||CASE WHEN MONTH(FECEMI)>9 THEN CHAR(MONTH(FECEMI)) ELSE         ''0''||CHAR(MONTH(FECEMI)) END CCANOMES, '+
        ' ''49'' TDIARID,CCNOREG,FECEMI CCFCMPRB, ''03'' AUXID,N.CDCLIE CLIEID,'''' CLIEDES, '+
        ' '''' CLIERUC,''12'' DOCID,SUBSTR(CDNCARG,1,3) CCSERIE, '+
        ' SUBSTR(CDNCARG,4,7) CCNODOC,FECEMI CCFEMIS, TPMONE TMONID, TPCAMB CCTCAMPR, ''P'' CCESTADO, '+
        ' COALESCE(TOAFECT,0) CCGRAVAD,COALESCE(TOIGV,0) CCIGV,COALESCE(TOAFECT,0)+COALESCE(TOIGV,0) CCMTOORI, '+
        ' ROUND((COALESCE(TOAFECT,0)+COALESCE(TOIGV,0))*COALESCE(TPCAMB,1),2) CCMTOLOC, '+
        ' COALESCE(TOAFECT,0)+COALESCE(TOIGV,0) CCMTOEXT, '+
        ' ROUND(COALESCE(TOAFECT,0)+COALESCE(TOIGV,0)-SALDO,2) CCPAGORI, '+
        ' ROUND((COALESCE(TOAFECT,0)+COALESCE(TOIGV,0)-SALDO)*COALESCE(TPCAMB,1),2) CCPAGLOC, '+
        ' ROUND(COALESCE(TOAFECT,0)+COALESCE(TOIGV,0)-SALDO,2) CCPAGEXT, '+
        ' SALDO CCSALORI, ROUND(SALDO*COALESCE(TPCAMB,1),2) CCSALLOC, '+
        ' SALDO CCSALEXT,N.CDUSER CCUSER, CURRENT DATE CCFREG, CURRENT TIME CCHREG,''N'' FGEN_DOC, '+
        ' SUBSTR(N.CDZONA,1,2) TVTAID, ''.'' CCFLAGVTA,''.'' FLAGVAR, CDZONA ZVTAID, '+
        ' CASE WHEN SUBSTR(CDZONA,1,2)=''01'' THEN ''12074'' ELSE ''12073'' END CCPTOTOT, '+
        ' CASE WHEN SUBSTR(CDZONA,1,2)=''01'' THEN ''121030201'' ELSE ''121030250'' END CTATOTAL,''03'' UBIID '+
        ' FROM SICTNCG1 N ';
     try
       DM1.DCOM1.AppServer.EjecutaSQL(sSQL);
     except
       Raise Exception.Create('Se ha producido un Error al Migrar las N. Débito con Saldo');
     end;
  panel1.visible:=False;
  Screen.Cursor:=crDefault;
  ShowMessage('Se Migraron Correctamente las N. Débito con Saldo');
end;

procedure TForm1.Button9Click(Sender: TObject);
var sSQL:string;
begin
  Screen.Cursor:=crHourGlass;
  Panel1.caption:=' GENERANDO N. CREDITO CANCELADAS ';
  panel1.visible:=True;
  Panel1.refresh;

  sSQL:=' INSERT INTO CXC301 '+
        ' (CIAID,CCANOMES,TDIARID,CCNOREG,CCFCMPRB,CLAUXID,CLIEID,CLIERUC,DOCID,CCSERIE,CCNODOC,CCFEMIS, '+
        ' TMONID,CCTCAMPR,CCESTADO,CCGRAVAD,CCIGV,CCMTOORI,CCMTOLOC,CCMTOEXT,CCPAGORI,CCPAGLOC,CCPAGEXT, '+
        ' CCSALORI,CCSALLOC,CCSALEXT,CCUSER,CCFREG,CCHREG,FGEN_DOC,CLIEDES,TVTAID,CCFLAGVTA,FLAGVAR,ZVTAID,CCPTOTOT,CTATOTAL,UBIID) '+
        ' SELECT  ''01'' CIAID,RTRIM(LTRIM(CHAR(YEAR(FECEMI))))||CASE WHEN MONTH(FECEMI)>9 THEN CHAR(MONTH(FECEMI)) ELSE         ''0''||CHAR(MONTH(FECEMI)) END CCANOMES, '+
        ' ''49'' TDIARID,CCNOREG,FECEMI CCFCMPRB, ''03'' AUXID,N.CDCLIE CLIEID, '+
        ' '''' CLIERUC,''11'' DOCID,SUBSTR(CDNABO,1,3) CCSERIE, '+
        ' SUBSTR(CDNABO,4,7) CCNODOC,FECEMI CCFEMIS, TPMONE TMONID, TPCAMB CCTCAMPR, ''C'' CCESTADO, '+
        ' COALESCE(NETO_S_IGV,0) CCGRAVAD, COALESCE(IGV,0) CCIGV, COALESCE(EMBALAJE,0)+COALESCE(NETO_S_IGV,0)+COALESCE(IGV,0) CCMTOORI, '+
        ' ROUND((COALESCE(NETO_S_IGV,0)+COALESCE(IGV,0)+COALESCE(EMBALAJE,0))*COALESCE(TPCAMB,1),2) CCMTOLOC, '+
        ' COALESCE(NETO_S_IGV,0)+COALESCE(IGV,0)+COALESCE(EMBALAJE,0) CCMTOEXT, '+
        ' ROUND(COALESCE(NETO_S_IGV,0)+COALESCE(IGV,0)+COALESCE(EMBALAJE,0)-COALESCE(SALDO,0),2) CCPAGORI, '+
        ' ROUND((COALESCE(NETO_S_IGV,0)+COALESCE(IGV,0)+COALESCE(EMBALAJE,0)-COALESCE(SALDO,0))*COALESCE(TPCAMB,1),2) CCPAGLOC, '+
        ' ROUND(COALESCE(NETO_S_IGV,0)+COALESCE(IGV,0)+COALESCE(EMBALAJE,0)-COALESCE(SALDO,0),2) CCPAGEXT, '+
        ' COALESCE(SALDO,0) CCSALORI, '+
        ' ROUND(COALESCE(SALDO,0)*COALESCE(TPCAMB,1),2) CCSALLOC, '+
        ' COALESCE(SALDO,0) CCSALEXT,N.CDUSER CCUSER, CURRENT DATE CCFREG, CURRENT TIME CCHREG,''N'' FGEN_DOC, '+
        ' '''' CLIEDES,SUBSTR(N.CDZONA,1,2) TVTAID, ''.'' CCFLAGVTA,''.'' FLAGVAR, CDZONA ZVTAID, '+
        ' CASE WHEN SUBSTR(CDZONA,1,2)=''01'' THEN ''11052'' ELSE ''11053'' END CCPTOTOT, '+
        ' CASE WHEN SUBSTR(CDZONA,1,2)=''01'' THEN ''121040201'' ELSE ''121040250'' END CTATOTAL,''03'' UBIID '+
        ' FROM CICTNAB1 N ';
     try
       DM1.DCOM1.AppServer.EjecutaSQL(sSQL);
     except
       Raise Exception.Create('Se ha producido un Error al Migrar las N. Crédito Canceladas');
     end;
  panel1.visible:=False;
  Screen.Cursor:=crDefault;
  ShowMessage('Se Migraron Correctamente las N. Crédito Canceladas');
end;

procedure TForm1.Button10Click(Sender: TObject);
var sSQL:string;
begin
  Screen.Cursor:=crHourGlass;
  Panel1.caption:=' GENERANDO N. CREDITO CON SALDO ';
  panel1.visible:=True;
  Panel1.refresh;

  sSQL:=' INSERT INTO CXC301 '+
        ' (CIAID,CCANOMES,TDIARID,CCNOREG,CCFCMPRB,CLAUXID,CLIEID,CLIERUC,DOCID,CCSERIE,CCNODOC,CCFEMIS, '+
        ' TMONID,CCTCAMPR,CCESTADO,CCGRAVAD,CCIGV,CCMTOORI,CCMTOLOC,CCMTOEXT,CCPAGORI,CCPAGLOC,CCPAGEXT, '+
        ' CCSALORI,CCSALLOC,CCSALEXT,CCUSER,CCFREG,CCHREG,FGEN_DOC,CLIEDES,TVTAID,CCFLAGVTA,FLAGVAR,ZVTAID,CCPTOTOT,CTATOTAL,UBIID) '+
        ' SELECT  ''01'' CIAID,RTRIM(LTRIM(CHAR(YEAR(FECEMI))))||CASE WHEN MONTH(FECEMI)>9 THEN CHAR(MONTH(FECEMI)) ELSE         ''0''||CHAR(MONTH(FECEMI)) END CCANOMES, '+
        ' ''49'' TDIARID,CCNOREG,FECEMI CCFCMPRB, ''03'' AUXID,N.CDCLIE CLIEID, '+
        ' '''' CLIERUC,''11'' DOCID,SUBSTR(CDNABO,1,3) CCSERIE, '+
        ' SUBSTR(CDNABO,4,7) CCNODOC,FECEMI CCFEMIS, TPMONE TMONID, TPCAMB CCTCAMPR, ''P'' CCESTADO, '+
        ' COALESCE(NETO_S_IGV,0) CCGRAVAD, COALESCE(IGV,0) CCIGV, COALESCE(EMBALAJE,0)+COALESCE(NETO_S_IGV,0)+COALESCE(IGV,0) CCMTOORI, '+
        ' ROUND((COALESCE(NETO_S_IGV,0)+COALESCE(IGV,0)+COALESCE(EMBALAJE,0))*COALESCE(TPCAMB,1),2) CCMTOLOC, '+
        ' COALESCE(NETO_S_IGV,0)+COALESCE(IGV,0)+COALESCE(EMBALAJE,0) CCMTOEXT, '+
        ' ROUND(COALESCE(NETO_S_IGV,0)+COALESCE(IGV,0)+COALESCE(EMBALAJE,0)-COALESCE(SALDO,0),2) CCPAGORI, '+
        ' ROUND((COALESCE(NETO_S_IGV,0)+COALESCE(IGV,0)+COALESCE(EMBALAJE,0)-COALESCE(SALDO,0))*COALESCE(TPCAMB,1),2) CCPAGLOC, '+
        ' ROUND(COALESCE(NETO_S_IGV,0)+COALESCE(IGV,0)+COALESCE(EMBALAJE,0)-COALESCE(SALDO,0),2) CCPAGEXT, '+
        ' COALESCE(SALDO,0) CCSALORI, '+
        ' ROUND(COALESCE(SALDO,0)*COALESCE(TPCAMB,1),2) CCSALLOC, '+
        ' COALESCE(SALDO,0) CCSALEXT,N.CDUSER CCUSER, CURRENT DATE CCFREG, CURRENT TIME CCHREG,''N'' FGEN_DOC, '+
        ' '''' CLIEDES,SUBSTR(N.CDZONA,1,2) TVTAID, ''.'' CCFLAGVTA,''.'' FLAGVAR, CDZONA ZVTAID, '+
        ' CASE WHEN SUBSTR(CDZONA,1,2)=''01'' THEN ''11052'' ELSE ''11053'' END CCPTOTOT, '+
        ' CASE WHEN SUBSTR(CDZONA,1,2)=''01'' THEN ''121040201'' ELSE ''121040250'' END CTATOTAL,''03'' UBIID '+
        ' FROM SICTNAB1 N ';
     try
       DM1.DCOM1.AppServer.EjecutaSQL(sSQL);
     except
       Raise Exception.Create('Se ha producido un Error al Migrar las N. Crédito con Saldo');
     end;
  panel1.visible:=False;
  Screen.Cursor:=crDefault;
  ShowMessage('Se Migraron Correctamente las N. Crédito con Saldo');
end;

procedure TForm1.Button11Click(Sender: TObject);
begin
  ShowMessage('No existen Cheques Diferidos Cancelados');
end;

procedure TForm1.Button12Click(Sender: TObject);
var sSQL:string;
begin
  Screen.Cursor:=crHourGlass;
  Panel1.caption:=' GENERANDO CHEQUES DIF. CON SALDO ';
  panel1.visible:=True;
  Panel1.refresh;
  sSQL:=' INSERT INTO CXC301 '+
        ' (CIAID,CCANOMES,TDIARID,CCLOTE,CCNOREG,CCFCMPRB,CLAUXID,CLIEID,CLIERUC,DOCID,CCSERIE,CCNODOC,CCFEMIS, '+
        ' CCFVCMTO,TMONID,CCTCAMPR,CCESTADO,CCMTOORI,CCMTOLOC,CCMTOEXT,CCPAGORI,CCPAGLOC,CCPAGEXT,CCSALORI,CCSALLOC,CCSALEXT, '+
        ' CCUSER,BANCOID,CCFREG,TVTAID,CLIEDES,FLAGVAR,TCANJEID,UBIID,ZVTAID) '+
        ' SELECT ''01'' CIAID,RTRIM(LTRIM(CHAR(YEAR(FECEMI))))||CASE WHEN MONTH(FECEMI)>9 THEN CHAR(MONTH(FECEMI)) ELSE         ''0''||CHAR(MONTH(FECEMI)) END CCANOMES, '+
        ' ''34'' TDIARID,''000'' CCLOTE,CCNOREG, FECEMI CCFCMPRB,''03'' CLAUXID,CH.CDCLIE CLIEID, '+
        ' '''' CLIERUC, '+
        ' ''19'' DOCID, '+
        ' ''000'' CCSERIE,CDCHEQ CCNODOC,FECEMI CCFEMIS,FECOBRO CCFVCMTO, '+
        ' TPMONE TMONID,TPCAMB CCTCAMPR,''P'' CCESTADO, '+
        ' COALESCE(IMPORTE,0) CCMTOORI, '+
        ' ROUND((COALESCE(IMPORTE,0))*COALESCE(TPCAMB,1),2) CCMTOLOC, '+
        ' COALESCE(IMPORTE,0) CCMTOEXT, '+
        ' ROUND(COALESCE(IMPORTE,0)-COALESCE(SALDO,0),2) CCPAGORI , '+
        ' ROUND((COALESCE(IMPORTE,0)-COALESCE(SALDO,0))*COALESCE(TPCAMB,1),2) CCPAGLOC , '+
        ' ROUND(COALESCE(IMPORTE,0)-COALESCE(SALDO,0),2) CCPAGEXT , '+
        ' COALESCE(SALDO,0) CCSALORI, '+
        ' ROUND(COALESCE(SALDO,0)*COALESCE(TPCAMB,1),2) CCSALLOC, '+
        ' COALESCE(SALDO,0) CCSALEXT, '+
        ' CH.CDUSER CCUSER, '+
        ' CASE WHEN CDBANCO=''03'' THEN ''02'' ELSE CASE WHEN CDBANCO=''02'' THEN ''03'' ELSE CDBANCO END END BANCOID, '+
        ' FESTAT CCFREG,SUBSTR(CH.CDZONA,1,2) TVTAID, '+
        ' '''' CLIEDES,''.'' FLAGVAR,''DI'' TCANJEID,''03'' UBIID, CH.CDZONA '+
        ' FROM SCHEDIF CH ';
     try
       DM1.DCOM1.AppServer.EjecutaSQL(sSQL);
     except
       Raise Exception.Create('Se ha producido un Error al Migrar los Cheques Dif. con Saldo');
     end;
  panel1.visible:=False;
  Screen.Cursor:=crDefault;
  ShowMessage('Se Migraron Correctamente los Cheques Dif. con Saldo');
end;

procedure TForm1.Button13Click(Sender: TObject);
var sSQL:string;
begin
  Screen.Cursor:=crHourGlass;
  Panel1.caption:=' GENERANDO CHEQUES NOR. CANCELADOS ';
  panel1.visible:=True;
  Panel1.refresh;
  sSQL:='INSERT INTO CXC301 '+
        ' (CIAID,CCANOMES,TDIARID,CCLOTE,CCNOREG,CCFCMPRB,CLAUXID,CLIEID,CLIERUC,DOCID,CCSERIE,CCNODOC,CCFEMIS, '+
        ' CCFVCMTO,TMONID,CCTCAMPR,CCESTADO,CCMTOORI,CCMTOLOC,CCMTOEXT,CCPAGORI,CCPAGLOC,CCPAGEXT,CCSALORI,CCSALLOC,CCSALEXT, '+
        ' CCUSER,BANCOID,CCFREG,TVTAID,CLIEDES,FLAGVAR,TCANJEID,UBIID,ZVTAID) '+
        ' SELECT ''01'' CIAID,RTRIM(LTRIM(CHAR(YEAR(FECEMI))))||CASE WHEN MONTH(FECEMI)>9 THEN CHAR(MONTH(FECEMI)) ELSE         ''0''||CHAR(MONTH(FECEMI)) END CCANOMES, '+
        ' ''34'' TDIARID,''000'' CCLOTE,CCNOREG, FECEMI CCFCMPRB,''03'' CLAUXID,CH.CDCLIE CLIEID, '+
        ' '''' CLIERUC, ''19'' DOCID, '+
        ' ''000'' CCSERIE,CDCHEQ CCNODOC,FECEMI CCFEMIS,FECOBRO CCFVCMTO, '+
        ' TPMONE TMONID,TPCAMB CCTCAMPR,''C'' CCESTADO, '+
        ' COALESCE(IMPORTE,0) CCMTOORI, '+
        ' ROUND((COALESCE(IMPORTE,0))*COALESCE(TPCAMB,1),2) CCMTOLOC, '+
        ' COALESCE(IMPORTE,0) CCMTOEXT, '+
        ' ROUND(COALESCE(IMPORTE,0)-COALESCE(SALDO,0),2) CCPAGORI , '+
        ' ROUND((COALESCE(IMPORTE,0)-COALESCE(SALDO,0))*COALESCE(TPCAMB,1),2) CCPAGLOC , '+
        ' ROUND(COALESCE(IMPORTE,0)-COALESCE(SALDO,0),2) CCPAGEXT , '+
        ' COALESCE(SALDO,0) CCSALORI, '+
        ' ROUND(COALESCE(SALDO,0)*COALESCE(TPCAMB,1),2) CCSALLOC, '+
        ' COALESCE(SALDO,0) CCSALEXT, '+
        ' CH.CDUSER CCUSER, '+
        ' CASE WHEN CDBANCO=''03'' THEN ''02'' ELSE CASE WHEN CDBANCO=''02'' THEN ''03'' ELSE CDBANCO END END BANCOID, '+
        ' FESTAT CCFREG,SUBSTR(CH.CDZONA,1,2) TVTAID, '+
        ' '''' CLIEDES,''.'' FLAGVAR,CASE WHEN STATCHEQ=''03'' THEN ''DE'' ELSE NULL END TCANJEID,''03'' UBIID, CH.CDZONA '+
        ' FROM CICTCHE1 CH ';
     try
       DM1.DCOM1.AppServer.EjecutaSQL(sSQL);
     except
       Raise Exception.Create('Se ha producido un Error al Migrar los Cheques Nor. Cancelados');
     end;

  panel1.visible:=False;
  Screen.Cursor:=crDefault;
  ShowMessage('Se Migraron Correctamente los Cheques Nor. Cancelados');
end;

procedure TForm1.Button14Click(Sender: TObject);
var sSQL:string;
begin
  Screen.Cursor:=crHourGlass;
  Panel1.caption:=' GENERANDO CHEQUES NOR. CON SALDO ';
  panel1.visible:=True;
  Panel1.refresh;
  sSQL:='INSERT INTO CXC301 '+
        ' (CIAID,CCANOMES,TDIARID,CCLOTE,CCNOREG,CCFCMPRB,CLAUXID,CLIEID,CLIERUC,DOCID,CCSERIE,CCNODOC,CCFEMIS, '+
        ' CCFVCMTO,TMONID,CCTCAMPR,CCESTADO,CCMTOORI,CCMTOLOC,CCMTOEXT,CCPAGORI,CCPAGLOC,CCPAGEXT,CCSALORI,CCSALLOC,CCSALEXT, '+
        ' CCUSER,BANCOID,CCFREG,TVTAID,CLIEDES,FLAGVAR,TCANJEID,UBIID,ZVTAID) '+
        ' SELECT ''01'' CIAID,RTRIM(LTRIM(CHAR(YEAR(FECEMI))))||CASE WHEN MONTH(FECEMI)>9 THEN CHAR(MONTH(FECEMI)) ELSE         ''0''||CHAR(MONTH(FECEMI)) END CCANOMES, '+
        ' ''34'' TDIARID,''000'' CCLOTE,CCNOREG, FECEMI CCFCMPRB,''03'' CLAUXID,CH.CDCLIE CLIEID, '+
        ' '''' CLIERUC, ''19'' DOCID, '+
        ' ''000'' CCSERIE,CDCHEQ CCNODOC,FECEMI CCFEMIS,FECOBRO CCFVCMTO, '+
        ' TPMONE TMONID,TPCAMB CCTCAMPR,''P'' CCESTADO, '+
        ' COALESCE(IMPORTE,0) CCMTOORI, '+
        ' ROUND((COALESCE(IMPORTE,0))*COALESCE(TPCAMB,1),2) CCMTOLOC, '+
        ' COALESCE(IMPORTE,0) CCMTOEXT, '+
        ' ROUND(COALESCE(IMPORTE,0)-COALESCE(SALDO,0),2) CCPAGORI , '+
        ' ROUND((COALESCE(IMPORTE,0)-COALESCE(SALDO,0))*COALESCE(TPCAMB,1),2) CCPAGLOC , '+
        ' ROUND(COALESCE(IMPORTE,0)-COALESCE(SALDO,0),2) CCPAGEXT , '+
        ' COALESCE(SALDO,0) CCSALORI, '+
        ' ROUND(COALESCE(SALDO,0)*COALESCE(TPCAMB,1),2) CCSALLOC, '+
        ' COALESCE(SALDO,0) CCSALEXT, '+
        ' CH.CDUSER CCUSER, '+
        ' CASE WHEN CDBANCO=''03'' THEN ''02'' ELSE CASE WHEN CDBANCO=''02'' THEN ''03'' ELSE CDBANCO END END BANCOID, '+
        ' FESTAT CCFREG,SUBSTR(CH.CDZONA,1,2) TVTAID, '+
        ' '''' CLIEDES,''.'' FLAGVAR,CASE WHEN STATCHEQ=''03'' THEN ''DE'' ELSE NULL END TCANJEID,''03'' UBIID, CH.CDZONA '+
        ' FROM SICTCHE1 CH ';
     try
       DM1.DCOM1.AppServer.EjecutaSQL(sSQL);
     except
       Raise Exception.Create('Se ha producido un Error al Migrar los Cheques Nor. con Saldo');
     end;

  panel1.visible:=False;
  Screen.Cursor:=crDefault;
  ShowMessage('Se Migraron Correctamente los Cheques Nor. con Saldo');
end;

procedure TForm1.Button15Click(Sender: TObject);
var sSQL:string;
begin
  Screen.Cursor:=crHourGlass;
  Panel1.caption:=' GENERANDO ANTICIPOS CANCELADOS ';
  panel1.visible:=True;
  Panel1.refresh;

  sSQL:=' INSERT INTO CXC301 '+
        ' (CIAID,CCANOMES,TDIARID,CCLOTE,CCNOREG,CCFCMPRB,CLAUXID,CLIEID,CLIERUC,DOCID,CCSERIE,CCNODOC,CCFEMIS,TMONID,CCTCAMPR, '+
        ' CCESTADO,CCMTOORI,CCMTOLOC,CCMTOEXT,CCPAGORI,CCPAGLOC,CCPAGEXT,CCSALORI,CCSALLOC,CCSALEXT,CCAAAA,CCMM,CCDD,CCTRI,CCSEM, '+
        ' CCSS,CCAATRI,CCAASEM,CCAASS,BANCOID,CCUSER,CCFREG,CLIEDES,TVTAID,ZVTAID) '+
        ' SELECT ''01'' CIAID, '+
        ' RTRIM(LTRIM(CHAR(YEAR(FECANC))))||CASE WHEN MONTH(FECANC)>9 THEN CHAR(MONTH(FECANC)) ELSE         ''0''||CHAR(MONTH(FECANC)) END CCANOMES, '+
        ' ''61'' TDIARID, ''000'' CCLOTE, CCNOREG CCNOREG, A.FECANC CCFCMPRB, ''03'' CLAUXID, A.CDCLIE CLIEID, '''' CLIERUC, ''24'' DOCID, '+
        ' ''000'' CCSERIE, A.CDANTI CCNODOC, A.FECANC CCFEMIS, A.TPMONE TMONID, A.TPCAMB CCTCAMPR,''C'' CCESTADO, '+
        ' COALESCE(A.IMPORTE,0) CCMTOORI, ROUND(COALESCE(A.IMPORTE,0)*COALESCE(A.TPCAMB,0),2) CCMTOLOC, '+
        ' COALESCE(A.IMPORTE,0) CCMTOEXT, '+
        ' COALESCE(A.IMPORTE,0)-COALESCE(A.SALDO,0) CCPAGORI, ROUND((COALESCE(A.IMPORTE,0)-COALESCE(A.SALDO,0))*COALESCE(A.TPCAMB,0),2) CCPAGLOC, '+
        ' COALESCE(A.IMPORTE,0)-COALESCE(A.SALDO,0) CCPAGEXT, '+
        ' COALESCE(A.SALDO,0) CCSALORI, ROUND(COALESCE(A.SALDO,0)*COALESCE(A.TPCAMB,0),2) CCSALLOC, '+
        ' COALESCE(A.SALDO,0) CCSALEXT, '+
        ' RTRIM(LTRIM(CHAR(YEAR(FECANC)))) CCAAAA,'''' CCMM, '''' CCDD, '''' CCTRI, '''' CCSEM, '+
        ' '''' CCSS,'''' CCAATRI,'''' CCAASEM, '''' CCAASS, '+
        ' CASE WHEN CDBANCO=''03'' THEN ''02'' ELSE CDBANCO END BANCOID, '+
        ' CDUSER CCUSER,FEREGI CCFREG,'''' CLIEDES,SUBSTR(A.CDZONA,1,2) TVTAID, A.CDZONA ZVTAID '+
        ' FROM  CICTANT1 A ';
     try
       DM1.DCOM1.AppServer.EjecutaSQL(sSQL);
     except
       Raise Exception.Create('Se ha producido un Error al Migrar los Anticipos Cancelados');
     end;

  panel1.visible:=False;
  Screen.Cursor:=crDefault;
  ShowMessage('Se Migraron Correctamente los Anticipos Cancelados');
end;

procedure TForm1.Button16Click(Sender: TObject);
var sSQL:string;
begin
  Screen.Cursor:=crHourGlass;
  Panel1.caption:=' GENERANDO ANTICIPOS PENDIENTES ';
  panel1.visible:=True;
  Panel1.refresh;

  sSQL:=' INSERT INTO CXC301 '+
        ' (CIAID,CCANOMES,TDIARID,CCLOTE,CCNOREG,CCFCMPRB,CLAUXID,CLIEID,CLIERUC,DOCID,CCSERIE,CCNODOC,CCFEMIS,TMONID,CCTCAMPR, '+
        ' CCESTADO,CCMTOORI,CCMTOLOC,CCMTOEXT,CCPAGORI,CCPAGLOC,CCPAGEXT,CCSALORI,CCSALLOC,CCSALEXT,CCAAAA,CCMM,CCDD,CCTRI,CCSEM, '+
        ' CCSS,CCAATRI,CCAASEM,CCAASS,BANCOID,CCUSER,CCFREG,CLIEDES,TVTAID,ZVTAID) '+
        ' SELECT ''01'' CIAID, '+
        ' RTRIM(LTRIM(CHAR(YEAR(FECANC))))||CASE WHEN MONTH(FECANC)>9 THEN CHAR(MONTH(FECANC)) ELSE         ''0''||CHAR(MONTH(FECANC)) END CCANOMES, '+
        ' ''61'' TDIARID, ''000'' CCLOTE, CCNOREG CCNOREG, A.FECANC CCFCMPRB, ''03'' CLAUXID, A.CDCLIE CLIEID, '''' CLIERUC, ''24'' DOCID, '+
        ' ''000'' CCSERIE, A.CDANTI CCNODOC, A.FECANC CCFEMIS, A.TPMONE TMONID, A.TPCAMB CCTCAMPR,''P'' CCESTADO, '+
        ' COALESCE(A.IMPORTE,0) CCMTOORI, ROUND(COALESCE(A.IMPORTE,0)*COALESCE(A.TPCAMB,0),2) CCMTOLOC, '+
        ' COALESCE(A.IMPORTE,0) CCMTOEXT, '+
        ' COALESCE(A.IMPORTE,0)-COALESCE(A.SALDO,0) CCPAGORI, ROUND((COALESCE(A.IMPORTE,0)-COALESCE(A.SALDO,0))*COALESCE(A.TPCAMB,0),2) CCPAGLOC, '+
        ' COALESCE(A.IMPORTE,0)-COALESCE(A.SALDO,0) CCPAGEXT, '+
        ' COALESCE(A.SALDO,0) CCSALORI, ROUND(COALESCE(A.SALDO,0)*COALESCE(A.TPCAMB,0),2) CCSALLOC, '+
        ' COALESCE(A.SALDO,0) CCSALEXT, '+
        ' RTRIM(LTRIM(CHAR(YEAR(FECANC)))) CCAAAA,'''' CCMM, '''' CCDD, '''' CCTRI, '''' CCSEM, '+
        ' '''' CCSS,'''' CCAATRI,'''' CCAASEM, '''' CCAASS, '+
        ' CASE WHEN CDBANCO=''03'' THEN ''02'' ELSE CDBANCO END BANCOID, '+
        ' CDUSER CCUSER,FEREGI CCFREG,'''' CLIEDES,SUBSTR(A.CDZONA,1,2) TVTAID, A.CDZONA ZVTAID '+
        ' FROM  SICTANT1 A ';
     try
       DM1.DCOM1.AppServer.EjecutaSQL(sSQL);
     except
       Raise Exception.Create('Se ha producido un Error al Migrar los Anticipos Cancelados');
     end;

  panel1.visible:=False;
  Screen.Cursor:=crDefault;
  ShowMessage('Se Migraron Correctamente los Anticipos Cancelados');
end;

end.
